import requests
from bs4 import BeautifulSoup
from pdf2image import convert_from_path
import pytesseract
from PIL import Image
import fitz
import os
import csv

pytesseract.pytesseract.tesseract_cmd = 'C:/Program Files/Tesseract-OCR/tesseract.exe'

def clean_text(text):
    return ' '.join(text.split())

def get_report_info(url, writer):
    response = requests.get(url)
    
    if response.status_code != 200:
        print(f"Failed to fetch {url}")
        return
    
    soup = BeautifulSoup(response.content, 'html.parser')
    pdf_links = [a['href'] for a in soup.find_all('a', class_='govuk-button')]
    
    if not pdf_links:
        print(f"No PDF links found on {url}")
        return
    
    report_link = pdf_links[0]
    
    pdf_text = extract_text_from_pdf(report_link)
    
    date_element = soup.find(lambda tag: tag.name == 'p' and 'Date of report:' in tag.get_text(), recursive=True)
    ref_element = soup.find(lambda tag: tag.name == 'p' and 'Ref:' in tag.get_text(), recursive=True)
    
    date = date_element.get_text() if date_element else 'N/A'
    id = ref_element.get_text() if ref_element else 'N/A'
    
    # Extract desired sections and remove empty lines
    section1_start = "THIS REPORT IS BEING SENT TO:"
    section1_end = " 1 CORONER"
    section2_start = " CONCERNS "
    section2_end = " 6 ACTION SHOULD BE TAKEN "
    print(url)
    try:
        section1 = pdf_text.split(section1_start)[1].split(section1_end)[0]
    except IndexError:
        # Handle the case where the section start or end markers are not found
        print("Error: Section not found. Check section1_start and section1_end markers.")
        section1 = "Default value"  # Set a default value for section1
    except Exception as e:
        # Handle other exceptions
        print(f"An error occurred: {str(e)}")
        section1 = "Default value"  # Set a default value for section1

    section1 = clean_text(section1)
    receiver = section1

    try:
        section2 = pdf_text.split(section2_start)[1].split(section2_end)[0]
    except IndexError:
        # Handle the case where the section start or end markers are not found
        print("Error: Section not found. Check section2_start and section2_end markers.")
        section2 = None
    except Exception as e:
        # Handle other exceptions
        print(f"An error occurred: {str(e)}")
        section2 = None

    content = section2

    # Remove empty lines
    if receiver != None and content != None:
        receiver = '\n'.join(line for line in receiver.splitlines() if line.strip())
        content = '\n'.join(line for line in content.splitlines() if line.strip())
    
    # Write to CSV
    writer.writerow([url, id, date, receiver, content])

def extract_text_from_pdf(pdf_url):
    response = requests.get(pdf_url)
    with open("temp.pdf", "wb") as pdf_file:
        pdf_file.write(response.content)

    pdf_document = fitz.open("temp.pdf")
    text = ""

    for page_number in range(pdf_document.page_count):
        page = pdf_document[page_number]
        text += page.get_text()

        if page.get_images(full=True):
            image = page.get_pixmap()
            image_text = perform_ocr_on_image(image)
            text += image_text
    
    pdf_document.close()
    os.remove("temp.pdf")

    text = clean_text(text)
    return text

def perform_ocr_on_image(image):
    pil_image = Image.frombytes("RGB", [image.width, image.height], image.samples)
    image_text = pytesseract.image_to_string(pil_image)
    return image_text

# Example usage:
urls = [
    "https://www.judiciary.uk/prevention-of-future-death-reports/carl-ellson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/jade-hutchings-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/lewis-johnson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/leanne-dunn-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-tilley-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/sarah-clarke-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/philip-battle-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/keith-weston-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-lee-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/ronald-kelly-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/ami-mitchell-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/liridon-saliuka-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/harry-evans-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/jessica-laverack-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/allan-waddup-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/vincenzo-lippolis-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-white-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/bradleigh-barnes-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/carl-langdell-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-osullivan-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/charley-patterson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/max-turbutt-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/seth-thind-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/neha-raju-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/molly-russell-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/katherine-tyrer-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/aleksandra-markowska-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/sandra-kirk-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/liam-lyes-watson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/surrey-coroner-area-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/adam-gallagher-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/gary-mcdonald-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/robert-brown-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-tice-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/gareth-williams-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-honnor-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-lloyd-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/lily-girton-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/lee-winslow-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/susan-regan-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/mathew-moore-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/robyn-skilton-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-boughton-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/archi-johnson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/ezra-tamiem-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-flint-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-booth-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kieran-crimmins-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-clements-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/antony-mclellan-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/dominic-noble-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/shona-campbell-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/zsolt-kirjak-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/alun-davies-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kate-hyatt-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/margaret-stringer-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/khalid-abiaz-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/manon-jones-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/mena-teferi-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/andrew-nixon-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/samuel-gomm-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/louise-allen-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/dean-crossman-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/zoe-zaremba-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/hannah-beardshaw-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/emma-pring-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/faizan-nazar-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/warwickshire-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-forryan-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-lacey-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephanie-moyce-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kaja-spiewak-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/theo-brennan-hulme-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/matthew-mcmanus-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/joy-burgess-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/jake-cahill-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/oskar-nash-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/ketheeswaren-kunarathnam-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/finnian-kitson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/darran-busby-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/jan-goodliffe-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/maziellie-mackenzie-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/ian-miller-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/gregory-barber-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/mark-castley-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-begg-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/anthony-fitzpatrick-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/robert-hammond-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/frances-thomas-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/alexander-tostevin-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/marshall-metcalfe-and-jane-ireland-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/connor-hoult-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/saif-hussain-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/joel-robinson-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/malcolm-dixon-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-hall-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/mared-foulkes-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/neil-bastock-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kyle-hurst-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-walker-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/richard-franks-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/sky-rollings-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/jane-bush-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/darren-lawrence-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/alexandra-tolley-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kirsty-doodes-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephen-cope-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/antony-schofield-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/charlie-todd-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/chloe-english-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/siwan-smith-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/lee-thrumble-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/brooke-martin-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/bituin-pimlott-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/todd-salter-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-regoli-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/kumbulani-mtombeni-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/stuart-tokam-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-pykett-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/amanda-dunn/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-nowshadi-prevention-of-future-deaths-report/", "https://www.judiciary.uk/prevention-of-future-death-reports/alan-griffin/", "https://www.judiciary.uk/prevention-of-future-death-reports/eleanor-rose-murphy-richards/", "https://www.judiciary.uk/prevention-of-future-death-reports/maria-stancliffe-cook/", "https://www.judiciary.uk/prevention-of-future-death-reports/levi-petitt/", "https://www.judiciary.uk/prevention-of-future-death-reports/hazel-binks/", "https://www.judiciary.uk/prevention-of-future-death-reports/rodney-dixon/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-rennoldson/", "https://www.judiciary.uk/prevention-of-future-death-reports/marc-bennett/", "https://www.judiciary.uk/prevention-of-future-death-reports/denton-duhaney/", "https://www.judiciary.uk/prevention-of-future-death-reports/emiel-malinski/", "https://www.judiciary.uk/prevention-of-future-death-reports/geoffrey-hutton/", "https://www.judiciary.uk/prevention-of-future-death-reports/mark-culverhouse/", "https://www.judiciary.uk/prevention-of-future-death-reports/kesia-waller/", "https://www.judiciary.uk/prevention-of-future-death-reports/samantha-gould/", "https://www.judiciary.uk/prevention-of-future-death-reports/christine-gould/", "https://www.judiciary.uk/prevention-of-future-death-reports/samantha-gould-and-christine-gould/", "https://www.judiciary.uk/prevention-of-future-death-reports/angela-frost/", "https://www.judiciary.uk/prevention-of-future-death-reports/kelly-hewitt/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-devenny/", "https://www.judiciary.uk/prevention-of-future-death-reports/matthew-mackell/", "https://www.judiciary.uk/prevention-of-future-death-reports/lisa-thompson/", "https://www.judiciary.uk/prevention-of-future-death-reports/dyllon-milburn/", "https://www.judiciary.uk/prevention-of-future-death-reports/neil-challinor-mooney/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephen-thurm/", "https://www.judiciary.uk/prevention-of-future-death-reports/hannah-bampfylde/", "https://www.judiciary.uk/prevention-of-future-death-reports/joanna-leven/", "https://www.judiciary.uk/prevention-of-future-death-reports/darren-adams/", "https://www.judiciary.uk/prevention-of-future-death-reports/sean-kay/", "https://www.judiciary.uk/prevention-of-future-death-reports/mary-gwanyama/", "https://www.judiciary.uk/prevention-of-future-death-reports/saima-hussain-mann/", "https://www.judiciary.uk/prevention-of-future-death-reports/hannah-browning/", "https://www.judiciary.uk/prevention-of-future-death-reports/mina-topley-bird/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-costello/", "https://www.judiciary.uk/prevention-of-future-death-reports/roy-morris/", "https://www.judiciary.uk/prevention-of-future-death-reports/rory-attwood/", "https://www.judiciary.uk/prevention-of-future-death-reports/azra-hussain/", "https://www.judiciary.uk/prevention-of-future-death-reports/timothy-steele/", "https://www.judiciary.uk/prevention-of-future-death-reports/grazyna-walczak/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-stout/", "https://www.judiciary.uk/prevention-of-future-death-reports/jaden-francois-espirit/", "https://www.judiciary.uk/prevention-of-future-death-reports/michael-dent-jones/", "https://www.judiciary.uk/prevention-of-future-death-reports/robert-hardy/", "https://www.judiciary.uk/prevention-of-future-death-reports/carole-mitchell/", "https://www.judiciary.uk/prevention-of-future-death-reports/michael-dobson/", "https://www.judiciary.uk/prevention-of-future-death-reports/valeria-biggs/", "https://www.judiciary.uk/prevention-of-future-death-reports/jason-orourke/", "https://www.judiciary.uk/prevention-of-future-death-reports/michael-woods/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-cooke/", "https://www.judiciary.uk/prevention-of-future-death-reports/james-taylor/", "https://www.judiciary.uk/prevention-of-future-death-reports/claire-lilley/", "https://www.judiciary.uk/prevention-of-future-death-reports/tina-murray/", "https://www.judiciary.uk/prevention-of-future-death-reports/andrew-gibbins/", "https://www.judiciary.uk/prevention-of-future-death-reports/emily-greene/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-swain/", "https://www.judiciary.uk/prevention-of-future-death-reports/kimberley-smith/", "https://www.judiciary.uk/prevention-of-future-death-reports/samuel-morgan/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-murfet/", "https://www.judiciary.uk/prevention-of-future-death-reports/roy-curtis/", "https://www.judiciary.uk/prevention-of-future-death-reports/neville-bardoliwala/", "https://www.judiciary.uk/prevention-of-future-death-reports/agnes-marchessou/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-ball/", "https://www.judiciary.uk/prevention-of-future-death-reports/sharon-kelly/", "https://www.judiciary.uk/prevention-of-future-death-reports/paul-hills/", "https://www.judiciary.uk/prevention-of-future-death-reports/imane-bouasbia/", "https://www.judiciary.uk/prevention-of-future-death-reports/xuanze-piao/", "https://www.judiciary.uk/prevention-of-future-death-reports/martin-barrett/", "https://www.judiciary.uk/prevention-of-future-death-reports/darrell-sharples/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-king/", "https://www.judiciary.uk/prevention-of-future-death-reports/piotr-kierzkowski/", "https://www.judiciary.uk/prevention-of-future-death-reports/viktor-scott-brown/", "https://www.judiciary.uk/prevention-of-future-death-reports/patricia-ferguson/", "https://www.judiciary.uk/prevention-of-future-death-reports/francis-cooney/", "https://www.judiciary.uk/prevention-of-future-death-reports/mark-mallinson/", "https://www.judiciary.uk/prevention-of-future-death-reports/danny-holt-scapens/", "https://www.judiciary.uk/prevention-of-future-death-reports/gary-etherington/", "https://www.judiciary.uk/prevention-of-future-death-reports/dean-george/", "https://www.judiciary.uk/prevention-of-future-death-reports/sam-pringle/", "https://www.judiciary.uk/prevention-of-future-death-reports/natasha-abrahart/", "https://www.judiciary.uk/prevention-of-future-death-reports/wilson-parkes/", "https://www.judiciary.uk/prevention-of-future-death-reports/lauren-finch/", "https://www.judiciary.uk/prevention-of-future-death-reports/raees-rauf/", "https://www.judiciary.uk/prevention-of-future-death-reports/simon-delahunty/", "https://www.judiciary.uk/prevention-of-future-death-reports/kelly-sutton/", "https://www.judiciary.uk/prevention-of-future-death-reports/lewis-francis/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-moran/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-ashley/", "https://www.judiciary.uk/prevention-of-future-death-reports/billy-jenkins/", "https://www.judiciary.uk/prevention-of-future-death-reports/ian-weeks/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-hursey/", "https://www.judiciary.uk/prevention-of-future-death-reports/carl-newman/", "https://www.judiciary.uk/prevention-of-future-death-reports/kerry-aldridge/", "https://www.judiciary.uk/prevention-of-future-death-reports/lee-carpenter/", "https://www.judiciary.uk/prevention-of-future-death-reports/shaun-turner/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-reilly/", "https://www.judiciary.uk/prevention-of-future-death-reports/andrew-goldstraw/", "https://www.judiciary.uk/prevention-of-future-death-reports/joseph-gingell/", "https://www.judiciary.uk/prevention-of-future-death-reports/gemma-azhar/", "https://www.judiciary.uk/prevention-of-future-death-reports/samantha-savage-greene/", "https://www.judiciary.uk/prevention-of-future-death-reports/marlon-watson/", "https://www.judiciary.uk/prevention-of-future-death-reports/deborah-lamont/", "https://www.judiciary.uk/prevention-of-future-death-reports/muhammed-wajid/", "https://www.judiciary.uk/prevention-of-future-death-reports/miles-naylor/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-akam/", "https://www.judiciary.uk/prevention-of-future-death-reports/tomasz-nowasad/", "https://www.judiciary.uk/prevention-of-future-death-reports/jacob-bates/", "https://www.judiciary.uk/prevention-of-future-death-reports/kieran-hubbard/", "https://www.judiciary.uk/prevention-of-future-death-reports/william-moody/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-marsland/", "https://www.judiciary.uk/prevention-of-future-death-reports/safoora-alam/", "https://www.judiciary.uk/prevention-of-future-death-reports/layla-dobson/", "https://www.judiciary.uk/prevention-of-future-death-reports/jessica-duckworth/", "https://www.judiciary.uk/prevention-of-future-death-reports/karis-braithwaite/", "https://www.judiciary.uk/prevention-of-future-death-reports/callie-lewis/", "https://www.judiciary.uk/prevention-of-future-death-reports/connor-davies/", "https://www.judiciary.uk/prevention-of-future-death-reports/shaun-dewey/", "https://www.judiciary.uk/prevention-of-future-death-reports/gary-leyland/", "https://www.judiciary.uk/prevention-of-future-death-reports/katie-croft/", "https://www.judiciary.uk/prevention-of-future-death-reports/darren-williams/", "https://www.judiciary.uk/prevention-of-future-death-reports/julius-little/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-kirsch/", "https://www.judiciary.uk/prevention-of-future-death-reports/george-rogers/", "https://www.judiciary.uk/prevention-of-future-death-reports/jane-livington/", "https://www.judiciary.uk/prevention-of-future-death-reports/ian-bean/", "https://www.judiciary.uk/prevention-of-future-death-reports/oliver-sharp/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-marshall/", "https://www.judiciary.uk/prevention-of-future-death-reports/99998-2/", "https://www.judiciary.uk/prevention-of-future-death-reports/ian-bromley/", "https://www.judiciary.uk/prevention-of-future-death-reports/peter-harrison/", "https://www.judiciary.uk/prevention-of-future-death-reports/gurdeep-singh-dundhal/", "https://www.judiciary.uk/prevention-of-future-death-reports/rebecca-henry/", "https://www.judiciary.uk/prevention-of-future-death-reports/richard-carlon/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-shorrocks/", "https://www.judiciary.uk/prevention-of-future-death-reports/reece-lapina-amarelle/", "https://www.judiciary.uk/prevention-of-future-death-reports/karen-burns/", "https://www.judiciary.uk/prevention-of-future-death-reports/tony-dunne/", "https://www.judiciary.uk/prevention-of-future-death-reports/carl-sargeant/", "https://www.judiciary.uk/prevention-of-future-death-reports/hannah-bharaj/", "https://www.judiciary.uk/prevention-of-future-death-reports/alistair-mcdonald/", "https://www.judiciary.uk/prevention-of-future-death-reports/sasha-forster/", "https://www.judiciary.uk/prevention-of-future-death-reports/anthony-walker/", "https://www.judiciary.uk/prevention-of-future-death-reports/benjamin-murray/", "https://www.judiciary.uk/prevention-of-future-death-reports/stuart-clark/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-key/", "https://www.judiciary.uk/prevention-of-future-death-reports/dane-pearson/", "https://www.judiciary.uk/prevention-of-future-death-reports/polly-drew/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-moss/", "https://www.judiciary.uk/prevention-of-future-death-reports/peter-garvin/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephen-kennedy/", "https://www.judiciary.uk/prevention-of-future-death-reports/matthew-lewis/", "https://www.judiciary.uk/prevention-of-future-death-reports/heather-carey/", "https://www.judiciary.uk/prevention-of-future-death-reports/anthony-watson/", "https://www.judiciary.uk/prevention-of-future-death-reports/robert-hughes/", "https://www.judiciary.uk/prevention-of-future-death-reports/ruth-edwards/", "https://www.judiciary.uk/prevention-of-future-death-reports/natalie-hunter/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-delahaye/", "https://www.judiciary.uk/prevention-of-future-death-reports/benjamin-williamson/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-mcguffie/", "https://www.judiciary.uk/prevention-of-future-death-reports/neil-swaisland/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-nicol/", "https://www.judiciary.uk/prevention-of-future-death-reports/ben-walmsley/", "https://www.judiciary.uk/prevention-of-future-death-reports/patricia-chambers/", "https://www.judiciary.uk/prevention-of-future-death-reports/billie-lord/", "https://www.judiciary.uk/prevention-of-future-death-reports/colette-dunn/", "https://www.judiciary.uk/prevention-of-future-death-reports/robin-mcewan/", "https://www.judiciary.uk/prevention-of-future-death-reports/jennifer-lacey/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-sargeant/", "https://www.judiciary.uk/prevention-of-future-death-reports/arun-viswambaran/", "https://www.judiciary.uk/prevention-of-future-death-reports/kevin-sherwood/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-collins-2/", "https://www.judiciary.uk/prevention-of-future-death-reports/terence-bennett/", "https://www.judiciary.uk/prevention-of-future-death-reports/cady-stewart/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephen-jackson/", "https://www.judiciary.uk/prevention-of-future-death-reports/bradley-morgan/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-lear/", "https://www.judiciary.uk/prevention-of-future-death-reports/michael-cooper/", "https://www.judiciary.uk/prevention-of-future-death-reports/daniel-omahony/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-hill/", "https://www.judiciary.uk/prevention-of-future-death-reports/andrew-hanahoe/", "https://www.judiciary.uk/prevention-of-future-death-reports/karen-wiggins/", "https://www.judiciary.uk/prevention-of-future-death-reports/george-dyson/", "https://www.judiciary.uk/prevention-of-future-death-reports/mwitumwa-ngenda/", "https://www.judiciary.uk/prevention-of-future-death-reports/grahame-searby/", "https://www.judiciary.uk/prevention-of-future-death-reports/stephen-tidey/", "https://www.judiciary.uk/prevention-of-future-death-reports/naseeb-chuhan/", "https://www.judiciary.uk/prevention-of-future-death-reports/kellie-taylor/", "https://www.judiciary.uk/prevention-of-future-death-reports/penelope-benton/", "https://www.judiciary.uk/prevention-of-future-death-reports/andrew-codling/", "https://www.judiciary.uk/prevention-of-future-death-reports/fallon-abby/", "https://www.judiciary.uk/prevention-of-future-death-reports/carly-gordon/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-wall/", "https://www.judiciary.uk/prevention-of-future-death-reports/sharon-halliwell/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-kierman/", "https://www.judiciary.uk/prevention-of-future-death-reports/sofia-legg/", "https://www.judiciary.uk/prevention-of-future-death-reports/dean-rowland/", "https://www.judiciary.uk/prevention-of-future-death-reports/kate-dolby/", "https://www.judiciary.uk/prevention-of-future-death-reports/charlotte-agnew/", "https://www.judiciary.uk/prevention-of-future-death-reports/callum-smith/", "https://www.judiciary.uk/prevention-of-future-death-reports/terry-latimer/", "https://www.judiciary.uk/prevention-of-future-death-reports/sarah-reed/", "https://www.judiciary.uk/prevention-of-future-death-reports/abigail-baynham/", "https://www.judiciary.uk/prevention-of-future-death-reports/lester-stacey/", "https://www.judiciary.uk/prevention-of-future-death-reports/annabel-lewis/", "https://www.judiciary.uk/prevention-of-future-death-reports/simon-turvey/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-green/", "https://www.judiciary.uk/prevention-of-future-death-reports/dean-saunders/", "https://www.judiciary.uk/prevention-of-future-death-reports/rachel-morgan/", "https://www.judiciary.uk/prevention-of-future-death-reports/richard-walsh/", "https://www.judiciary.uk/prevention-of-future-death-reports/wayne-cornlouer/", "https://www.judiciary.uk/prevention-of-future-death-reports/matthew-russell/", "https://www.judiciary.uk/prevention-of-future-death-reports/peter-usher/", "https://www.judiciary.uk/prevention-of-future-death-reports/david-knight/", "https://www.judiciary.uk/prevention-of-future-death-reports/emma-timbrell/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-atkinson/", "https://www.judiciary.uk/prevention-of-future-death-reports/georgina-lewis/", "https://www.judiciary.uk/prevention-of-future-death-reports/jaroslaw-rogala/", "https://www.judiciary.uk/prevention-of-future-death-reports/martyn-watkins/", "https://www.judiciary.uk/prevention-of-future-death-reports/demi-williams/", "https://www.judiciary.uk/prevention-of-future-death-reports/tedros-kahssay/", "https://www.judiciary.uk/prevention-of-future-death-reports/michaela-thompson/", "https://www.judiciary.uk/prevention-of-future-death-reports/samuel-carroll/", "https://www.judiciary.uk/prevention-of-future-death-reports/benjamin-orrill/", "https://www.judiciary.uk/prevention-of-future-death-reports/haydn-burton/", "https://www.judiciary.uk/prevention-of-future-death-reports/amy-el-keria/", "https://www.judiciary.uk/prevention-of-future-death-reports/liam-lambert/", "https://www.judiciary.uk/prevention-of-future-death-reports/charles-pitcher/", "https://www.judiciary.uk/prevention-of-future-death-reports/edward-mallen/", "https://www.judiciary.uk/prevention-of-future-death-reports/nathan-lowe/", "https://www.judiciary.uk/prevention-of-future-death-reports/darren-mindham-2/", "https://www.judiciary.uk/prevention-of-future-death-reports/susan-hamlett/", "https://www.judiciary.uk/prevention-of-future-death-reports/miles-abel/", "https://www.judiciary.uk/prevention-of-future-death-reports/michael-williams/", "https://www.judiciary.uk/prevention-of-future-death-reports/john-betteridge/", "https://www.judiciary.uk/prevention-of-future-death-reports/anielka-jennings/", "https://www.judiciary.uk/prevention-of-future-death-reports/christina-obrien/", "https://www.judiciary.uk/prevention-of-future-death-reports/kevin-dermott/", "https://www.judiciary.uk/prevention-of-future-death-reports/tracey-lynch/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-trudgill/", "https://www.judiciary.uk/prevention-of-future-death-reports/danielle-robinson/", "https://www.judiciary.uk/prevention-of-future-death-reports/ian-brown/", "https://www.judiciary.uk/prevention-of-future-death-reports/gillian-taylor/", "https://www.judiciary.uk/prevention-of-future-death-reports/ahmedreza-fathi/", "https://www.judiciary.uk/prevention-of-future-death-reports/darren-mindham/", "https://www.judiciary.uk/prevention-of-future-death-reports/thomas-harris/", "https://www.judiciary.uk/prevention-of-future-death-reports/steven-murphy/", "https://www.judiciary.uk/prevention-of-future-death-reports/luke-ayres/", "https://www.judiciary.uk/prevention-of-future-death-reports/helen-england/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-stubbs/", "https://www.judiciary.uk/prevention-of-future-death-reports/brenda-morris/", "https://www.judiciary.uk/prevention-of-future-death-reports/chentoori-chanthirakumar/", "https://www.judiciary.uk/prevention-of-future-death-reports/samantha-macdonald/", "https://www.judiciary.uk/prevention-of-future-death-reports/christopher-higgins/", "https://www.judiciary.uk/prevention-of-future-death-reports/jake-robinson/", "https://www.judiciary.uk/prevention-of-future-death-reports/piotr-kucharz/", "https://www.judiciary.uk/prevention-of-future-death-reports/alice-mead/", "https://www.judiciary.uk/prevention-of-future-death-reports/wanda-stachurska/", "https://www.judiciary.uk/prevention-of-future-death-reports/finnulla-martin/", "https://www.judiciary.uk/prevention-of-future-death-reports/aleysha-mcloughlin/", "https://www.judiciary.uk/prevention-of-future-death-reports/stuart-baumber/", "https://www.judiciary.uk/prevention-of-future-death-reports/brenda-leyland/", "https://www.judiciary.uk/prevention-of-future-death-reports/alasdair-penny/", "https://www.judiciary.uk/prevention-of-future-death-reports/craig-bell/", "https://www.judiciary.uk/prevention-of-future-death-reports/kimberley-parsons/", "https://www.judiciary.uk/prevention-of-future-death-reports/malcolm-burge/", "https://www.judiciary.uk/prevention-of-future-death-reports/isobel-griffin/"
]

csv_file_path = "output.csv"

with open(csv_file_path, 'w', newline='', encoding='utf-8') as csv_file:
    csv_writer = csv.writer(csv_file)
    csv_writer.writerow(['URL', 'ID', 'Date', 'Receiver', 'Content'])

    for url in urls:
        get_report_info(url, csv_writer)
